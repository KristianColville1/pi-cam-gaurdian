setup publisher/subscriber system on the server so pie can send events to it.

sudo apt update
sudo apt install mosquitto mosquitto-clients

![1767270903753](image/01-01-2026/1767270903753.png)

starting the service:

sudo systemctl enable mosquitto
sudo systemctl start mosquitto

![1767270949504](image/01-01-2026/1767270949504.png)

MQTT uses port 1883 on http

Open ports on server: update the ip table and security list on cloud.

sudo iptables -A INPUT -p tcp --dport 1883 -j ACCEPT

![1767272015212](image/01-01-2026/1767272015212.png)

![1767272055695](image/01-01-2026/1767272055695.png)

check ports listening: ss -nltp

![1767272193402](image/01-01-2026/1767272193402.png)

test basic communication

on the pi or a local linux machine:
mosquitto_sub -h your.server.ip -t test/topic

on the server:
mosquitto_pub -h your.server.ip -t test/topic -m "hello"
fix ports if necessary and save

i ran sudo iptables -I INPUT 5 -p tcp --dport 1883 -m conntrack --ctstate NEW -j ACCEPT

![1767274152501](image/01-01-2026/1767274152501.png)
![1767274217423](image/01-01-2026/1767274217423.png)

confirm on pi communication:

![1767274242550](image/01-01-2026/1767274242550.png)
